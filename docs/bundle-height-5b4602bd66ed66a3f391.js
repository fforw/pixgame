var Game=function(e){function t(t){for(var n,a,s=t[0],u=t[1],f=t[2],l=0,c=[];l<s.length;l++)a=s[l],i[a]&&c.push(i[a][0]),i[a]=0;for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(e[n]=u[n]);for(h&&h(t);c.length;)c.shift()();return o.push.apply(o,f||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],n=!0,s=1;s<r.length;s++){var u=r[s];0!==i[u]&&(n=!1)}n&&(o.splice(t--,1),e=a(a.s=r[0]))}return e}var n={},i={1:0},o=[];function a(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=n,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(r,n,function(t){return e[t]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var s=window.webpackJsonpGame=window.webpackJsonpGame||[],u=s.push.bind(s);s.push=t,s=s.slice();for(var f=0;f<s.length;f++)t(s[f]);var h=u;return o.push([32,0]),r()}({3:function(e,t,r){"use strict";r(5);var n,i,o=r(7),a=r.n(o),s=r(8),u=r(1),f=r.n(u);function h(e,t,r,n){var i,o=e.size,a=e.tiles,s=e.things;switch(n){case 0:case 1:s[(r-1)*o+t-1]=I,s[(r-1)*o+t]=I,s[(r-1)*o+t+1]=I,s[r*o+t-1]=I,L[a[i=r*o+t]]!==w&&(a[i]=G(e,k)),s[r*o+t+1]=I,s[(r+1)*o+t-1]=I,s[(r+1)*o+t]=I,s[(r+1)*o+t+1]=I;break;case 2:s[(r-1)*o+t-1]=I,s[(r-1)*o+t]=I,s[(r-1)*o+t+1]=I,s[(r-1)*o+t+2]=I,s[r*o+t-1]=I,L[a[i=r*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t+1]]!==w&&(a[i]=G(e,k)),s[r*o+t+2]=I,s[(r+1)*o+t-1]=I,s[(r+1)*o+t]=I,s[(r+1)*o+t+1]=I,s[(r+1)*o+t+2]=I;break;case 3:s[(r-3)*o+t]=I,s[(r-3)*o+t+1]=I,s[(r-2)*o+t-1]=I,s[(r-2)*o+t]=I,s[(r-2)*o+t+1]=I,s[(r-2)*o+t+2]=I,s[(r-1)*o+t-2]=I,s[(r-1)*o+t-1]=I,L[a[i=(r-1)*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t+1]]!==w&&(a[i]=G(e,k)),s[(r-1)*o+t+2]=I,s[(r-1)*o+t+3]=I,s[r*o+t-2]=I,s[r*o+t-1]=I,L[a[i=r*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t+1]]!==w&&(a[i]=G(e,k)),s[r*o+t+2]=I,s[r*o+t+3]=I,s[(r+1)*o+t-1]=I,s[(r+1)*o+t]=I,s[(r+1)*o+t+1]=I,s[(r+1)*o+t+2]=I,s[(r+2)*o+t]=I,s[(r+2)*o+t+1]=I;break;case 4:s[(r-3)*o+t-1]=I,s[(r-3)*o+t]=I,s[(r-3)*o+t+1]=I,s[(r-2)*o+t-2]=I,s[(r-2)*o+t-1]=I,s[(r-2)*o+t]=I,s[(r-2)*o+t+1]=I,s[(r-2)*o+t+2]=I,s[(r-1)*o+t-3]=I,s[(r-1)*o+t-2]=I,L[a[i=(r-1)*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t+1]]!==w&&(a[i]=G(e,k)),s[(r-1)*o+t+2]=I,s[(r-1)*o+t+3]=I,s[r*o+t-3]=I,s[r*o+t-2]=I,L[a[i=r*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t+1]]!==w&&(a[i]=G(e,k)),s[r*o+t+2]=I,s[r*o+t+3]=I,s[(r+1)*o+t-2]=I,s[(r+1)*o+t-1]=I,s[(r+1)*o+t]=I,s[(r+1)*o+t+1]=I,s[(r+1)*o+t+2]=I,s[(r+2)*o+t-1]=I,s[(r+2)*o+t]=I,s[(r+2)*o+t+1]=I;break;case 5:s[(r-3)*o+t-1]=I,s[(r-3)*o+t]=I,s[(r-3)*o+t+1]=I,s[(r-2)*o+t-2]=I,s[(r-2)*o+t-1]=I,s[(r-2)*o+t]=I,s[(r-2)*o+t+1]=I,s[(r-2)*o+t+2]=I,s[(r-1)*o+t-3]=I,s[(r-1)*o+t-2]=I,L[a[i=(r-1)*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t+1]]!==w&&(a[i]=G(e,k)),s[(r-1)*o+t+2]=I,s[(r-1)*o+t+3]=I,s[r*o+t-3]=I,s[r*o+t-2]=I,L[a[i=r*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t+1]]!==w&&(a[i]=G(e,k)),s[r*o+t+2]=I,s[r*o+t+3]=I,s[(r+1)*o+t-3]=I,s[(r+1)*o+t-2]=I,L[a[i=(r+1)*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=(r+1)*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=(r+1)*o+t+1]]!==w&&(a[i]=G(e,k)),s[(r+1)*o+t+2]=I,s[(r+1)*o+t+3]=I,s[(r+2)*o+t-2]=I,s[(r+2)*o+t-1]=I,s[(r+2)*o+t]=I,s[(r+2)*o+t+1]=I,s[(r+2)*o+t+2]=I,s[(r+3)*o+t-1]=I,s[(r+3)*o+t]=I,s[(r+3)*o+t+1]=I;break;case 6:s[(r-4)*o+t-1]=I,s[(r-4)*o+t]=I,s[(r-4)*o+t+1]=I,s[(r-3)*o+t-2]=I,s[(r-3)*o+t-1]=I,s[(r-3)*o+t]=I,s[(r-3)*o+t+1]=I,s[(r-3)*o+t+2]=I,s[(r-2)*o+t-3]=I,s[(r-2)*o+t-2]=I,L[a[i=(r-2)*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=(r-2)*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=(r-2)*o+t+1]]!==w&&(a[i]=G(e,k)),s[(r-2)*o+t+2]=I,s[(r-2)*o+t+3]=I,s[(r-1)*o+t-4]=I,s[(r-1)*o+t-3]=I,L[a[i=(r-1)*o+t-2]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t+1]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t+2]]!==w&&(a[i]=G(e,k)),s[(r-1)*o+t+3]=I,s[(r-1)*o+t+4]=I,s[r*o+t-4]=I,s[r*o+t-3]=I,L[a[i=r*o+t-2]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t+1]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t+2]]!==w&&(a[i]=G(e,k)),s[r*o+t+3]=I,s[r*o+t+4]=I,s[(r+1)*o+t-4]=I,s[(r+1)*o+t-3]=I,L[a[i=(r+1)*o+t-2]]!==w&&(a[i]=G(e,k)),L[a[i=(r+1)*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=(r+1)*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=(r+1)*o+t+1]]!==w&&(a[i]=G(e,k)),L[a[i=(r+1)*o+t+2]]!==w&&(a[i]=G(e,k)),s[(r+1)*o+t+3]=I,s[(r+1)*o+t+4]=I,s[(r+2)*o+t-3]=I,s[(r+2)*o+t-2]=I,L[a[i=(r+2)*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=(r+2)*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=(r+2)*o+t+1]]!==w&&(a[i]=G(e,k)),s[(r+2)*o+t+2]=I,s[(r+2)*o+t+3]=I,s[(r+3)*o+t-2]=I,s[(r+3)*o+t-1]=I,s[(r+3)*o+t]=I,s[(r+3)*o+t+1]=I,s[(r+3)*o+t+2]=I,s[(r+4)*o+t-1]=I,s[(r+4)*o+t]=I,s[(r+4)*o+t+1]=I;break;case 7:s[(r-5)*o+t-1]=I,s[(r-5)*o+t]=I,s[(r-5)*o+t+1]=I,s[(r-4)*o+t-2]=I,s[(r-4)*o+t-1]=I,s[(r-4)*o+t]=I,s[(r-4)*o+t+1]=I,s[(r-4)*o+t+2]=I,s[(r-3)*o+t-3]=I,s[(r-3)*o+t-2]=I,L[a[i=(r-3)*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=(r-3)*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=(r-3)*o+t+1]]!==w&&(a[i]=G(e,k)),s[(r-3)*o+t+2]=I,s[(r-3)*o+t+3]=I,s[(r-2)*o+t-4]=I,s[(r-2)*o+t-3]=I,L[a[i=(r-2)*o+t-2]]!==w&&(a[i]=G(e,k)),L[a[i=(r-2)*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=(r-2)*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=(r-2)*o+t+1]]!==w&&(a[i]=G(e,k)),L[a[i=(r-2)*o+t+2]]!==w&&(a[i]=G(e,k)),s[(r-2)*o+t+3]=I,s[(r-2)*o+t+4]=I,s[(r-1)*o+t-5]=I,s[(r-1)*o+t-4]=I,L[a[i=(r-1)*o+t-3]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t-2]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t+1]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t+2]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t+3]]!==w&&(a[i]=G(e,k)),s[(r-1)*o+t+4]=I,s[(r-1)*o+t+5]=I,s[r*o+t-5]=I,s[r*o+t-4]=I,L[a[i=r*o+t-3]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t-2]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t+1]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t+2]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t+3]]!==w&&(a[i]=G(e,k)),s[r*o+t+4]=I,s[r*o+t+5]=I,s[(r+1)*o+t-5]=I,s[(r+1)*o+t-4]=I,L[a[i=(r+1)*o+t-3]]!==w&&(a[i]=G(e,k)),L[a[i=(r+1)*o+t-2]]!==w&&(a[i]=G(e,k)),L[a[i=(r+1)*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=(r+1)*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=(r+1)*o+t+1]]!==w&&(a[i]=G(e,k)),L[a[i=(r+1)*o+t+2]]!==w&&(a[i]=G(e,k)),L[a[i=(r+1)*o+t+3]]!==w&&(a[i]=G(e,k)),s[(r+1)*o+t+4]=I,s[(r+1)*o+t+5]=I,s[(r+2)*o+t-4]=I,s[(r+2)*o+t-3]=I,L[a[i=(r+2)*o+t-2]]!==w&&(a[i]=G(e,k)),L[a[i=(r+2)*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=(r+2)*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=(r+2)*o+t+1]]!==w&&(a[i]=G(e,k)),L[a[i=(r+2)*o+t+2]]!==w&&(a[i]=G(e,k)),s[(r+2)*o+t+3]=I,s[(r+2)*o+t+4]=I,s[(r+3)*o+t-3]=I,s[(r+3)*o+t-2]=I,L[a[i=(r+3)*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=(r+3)*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=(r+3)*o+t+1]]!==w&&(a[i]=G(e,k)),s[(r+3)*o+t+2]=I,s[(r+3)*o+t+3]=I,s[(r+4)*o+t-2]=I,s[(r+4)*o+t-1]=I,s[(r+4)*o+t]=I,s[(r+4)*o+t+1]=I,s[(r+4)*o+t+2]=I,s[(r+5)*o+t-1]=I,s[(r+5)*o+t]=I,s[(r+5)*o+t+1]=I;break;case 8:s[(r-6)*o+t-1]=I,s[(r-6)*o+t]=I,s[(r-6)*o+t+1]=I,s[(r-5)*o+t-3]=I,s[(r-5)*o+t-2]=I,s[(r-5)*o+t-1]=I,s[(r-5)*o+t]=I,s[(r-5)*o+t+1]=I,s[(r-5)*o+t+2]=I,s[(r-5)*o+t+3]=I,s[(r-4)*o+t-4]=I,s[(r-4)*o+t-3]=I,s[(r-4)*o+t-2]=I,L[a[i=(r-4)*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=(r-4)*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=(r-4)*o+t+1]]!==w&&(a[i]=G(e,k)),s[(r-4)*o+t+2]=I,s[(r-4)*o+t+3]=I,s[(r-4)*o+t+4]=I,s[(r-3)*o+t-5]=I,s[(r-3)*o+t-4]=I,s[(r-3)*o+t-3]=I,L[a[i=(r-3)*o+t-2]]!==w&&(a[i]=G(e,k)),L[a[i=(r-3)*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=(r-3)*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=(r-3)*o+t+1]]!==w&&(a[i]=G(e,k)),L[a[i=(r-3)*o+t+2]]!==w&&(a[i]=G(e,k)),s[(r-3)*o+t+3]=I,s[(r-3)*o+t+4]=I,s[(r-3)*o+t+5]=I,s[(r-2)*o+t-5]=I,s[(r-2)*o+t-4]=I,L[a[i=(r-2)*o+t-3]]!==w&&(a[i]=G(e,k)),L[a[i=(r-2)*o+t-2]]!==w&&(a[i]=G(e,k)),L[a[i=(r-2)*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=(r-2)*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=(r-2)*o+t+1]]!==w&&(a[i]=G(e,k)),L[a[i=(r-2)*o+t+2]]!==w&&(a[i]=G(e,k)),L[a[i=(r-2)*o+t+3]]!==w&&(a[i]=G(e,k)),s[(r-2)*o+t+4]=I,s[(r-2)*o+t+5]=I,s[(r-1)*o+t-6]=I,s[(r-1)*o+t-5]=I,L[a[i=(r-1)*o+t-4]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t-3]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t-2]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t+1]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t+2]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t+3]]!==w&&(a[i]=G(e,k)),L[a[i=(r-1)*o+t+4]]!==w&&(a[i]=G(e,k)),s[(r-1)*o+t+5]=I,s[(r-1)*o+t+6]=I,s[r*o+t-6]=I,s[r*o+t-5]=I,L[a[i=r*o+t-4]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t-3]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t-2]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t+1]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t+2]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t+3]]!==w&&(a[i]=G(e,k)),L[a[i=r*o+t+4]]!==w&&(a[i]=G(e,k)),s[r*o+t+5]=I,s[r*o+t+6]=I,s[(r+1)*o+t-6]=I,s[(r+1)*o+t-5]=I,L[a[i=(r+1)*o+t-4]]!==w&&(a[i]=G(e,k)),L[a[i=(r+1)*o+t-3]]!==w&&(a[i]=G(e,k)),L[a[i=(r+1)*o+t-2]]!==w&&(a[i]=G(e,k)),L[a[i=(r+1)*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=(r+1)*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=(r+1)*o+t+1]]!==w&&(a[i]=G(e,k)),L[a[i=(r+1)*o+t+2]]!==w&&(a[i]=G(e,k)),L[a[i=(r+1)*o+t+3]]!==w&&(a[i]=G(e,k)),L[a[i=(r+1)*o+t+4]]!==w&&(a[i]=G(e,k)),s[(r+1)*o+t+5]=I,s[(r+1)*o+t+6]=I,s[(r+2)*o+t-5]=I,s[(r+2)*o+t-4]=I,L[a[i=(r+2)*o+t-3]]!==w&&(a[i]=G(e,k)),L[a[i=(r+2)*o+t-2]]!==w&&(a[i]=G(e,k)),L[a[i=(r+2)*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=(r+2)*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=(r+2)*o+t+1]]!==w&&(a[i]=G(e,k)),L[a[i=(r+2)*o+t+2]]!==w&&(a[i]=G(e,k)),L[a[i=(r+2)*o+t+3]]!==w&&(a[i]=G(e,k)),s[(r+2)*o+t+4]=I,s[(r+2)*o+t+5]=I,s[(r+3)*o+t-5]=I,s[(r+3)*o+t-4]=I,s[(r+3)*o+t-3]=I,L[a[i=(r+3)*o+t-2]]!==w&&(a[i]=G(e,k)),L[a[i=(r+3)*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=(r+3)*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=(r+3)*o+t+1]]!==w&&(a[i]=G(e,k)),L[a[i=(r+3)*o+t+2]]!==w&&(a[i]=G(e,k)),s[(r+3)*o+t+3]=I,s[(r+3)*o+t+4]=I,s[(r+3)*o+t+5]=I,s[(r+4)*o+t-4]=I,s[(r+4)*o+t-3]=I,s[(r+4)*o+t-2]=I,L[a[i=(r+4)*o+t-1]]!==w&&(a[i]=G(e,k)),L[a[i=(r+4)*o+t]]!==w&&(a[i]=G(e,k)),L[a[i=(r+4)*o+t+1]]!==w&&(a[i]=G(e,k)),s[(r+4)*o+t+2]=I,s[(r+4)*o+t+3]=I,s[(r+4)*o+t+4]=I,s[(r+5)*o+t-3]=I,s[(r+5)*o+t-2]=I,s[(r+5)*o+t-1]=I,s[(r+5)*o+t]=I,s[(r+5)*o+t+1]=I,s[(r+5)*o+t+2]=I,s[(r+5)*o+t+3]=I,s[(r+6)*o+t-1]=I,s[(r+6)*o+t]=I,s[(r+6)*o+t+1]=I;break;default:throw new Error("Unhandled width: "+n)}}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){var r=Object.keys(e);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(e)),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(r,!0).forEach(function(t){p(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,"e",function(){return w}),r.d(t,"c",function(){return k}),r.d(t,"b",function(){return O}),r.d(t,"a",function(){return I}),r.d(t,"d",function(){return L}),r.d(t,"g",function(){return G}),r.d(t,"f",function(){return J});var v=2*Math.PI,m=20,b=5;var y=.05,g=.07,x=.09,T=.5,w=0,S=3,C=6,A=9,R=12,M=15,z=16,k=19,O=22,I=1,P=2,_=3,B=10;function D(e){if(!e)return 0;for(var t=0,r=1;r<e.length;r+=2)t+=e[r];return t}var E=["WATER","WATER2","WATER3","SAND","SAND2","SAND3","GRASS","GRASS2","GRASS3","DIRT","DIRT2","DIRT3","ROCK","ROCK2","ROCK3","WOODS","WOODS2","WOODS3","WOODS4","RIVER","RIVER2","RIVER3","MARKER","MARKER2","MARKER3"],F=(p(n={},w,[w,1,2]),p(n,S,[S,4,5]),p(n,C,[C,7,8]),p(n,A,[A,10,11]),p(n,R,[R,13,14]),p(n,M,[M,17]),p(n,z,[z,18]),p(n,k,[k,20,21]),n),L=function(){var e=new Array(E.length);for(var t in F)if(F.hasOwnProperty(t)){var r=+t;e[r]=r;for(var n=F[t],i=0;i<n.length;i++){e[n[i]]=r}}return e}();var j=function(e){for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];if(r)for(var n=D(r),i=1;i<r.length;i+=2)r[i]/=n}return e}((p(i={},w,!1),p(i,S,[0,500,B,1,11,1]),p(i,C,[0,1e3,P,2,_,2,4,3,6,3,B,1,11,2]),p(i,A,[0,1e3,P,2,_,2,4,3,6,3,B,1,11,2]),p(i,R,[0,4,B,1,11,1]),p(i,M,[0,150,P,2,_,2,4,5,5,5,6,5,7,1,8,1,9,1,B,1,11,2]),p(i,z,[0,40,P,2,_,2,4,5,5,5,6,5,7,1,8,1,9,1,B,1,11,2]),p(i,k,!1),i));function G(e,t){var r,n=F[t];if(n){var i=n.length-1;r=0===i?n[0]:n[e.random.nextInt(0,i)]}else r=t;return r}function W(e,t){return L[e]===t}function U(e,t,r){var n=e.things,i=e.sizeMask;if(0===n[t]){var o=j[r];if(o){var a=function(e,t){var r=e.random.next(),n=1;do{r-=t[n],n+=2}while(r>0&&n<t.length);return t[n-3]}(e,o);if(a)if(a===P||a===_){var s=t-2&i,u=t-1&i,f=t+1&i,h=t+2&i,l=t+3&i;n[t-3&i]!==I&&n[s]!==I&&n[u]!==I&&(n[t]=a,n[f]=I,n[h]=I,n[l]=I)}else if(a===B){var c=t+1&i;n[t-1&i]!==I&&(n[t]=a,n[c]=I)}else n[t]=a}}else console.log("Skip spawning on ",n[t])}function V(e,t,r){var n=e.heightCoords(t,r),i=e.heightFn(t,r,n);if(i<y)return w;if(i<g)return S;if(i<T){var o=n.nx,a=n.ny,s=n.nz,u=n.nw,f=i>x?e.noise4D(o*b,u*b,a*b,s*b):1,h=e.noise4D(o*m,u*m,a*m,s*m);return f<0?h<0?M:z:h<0?C:A}return R}function N(e,t){for(var r=new J(e,t),n=r.tiles,i=0,o=0;o<e;o++)for(var a=0;a<e;a++){var s=V(r,a,o);n[i]=G(r,s),U(r,i,s),i++}return r}var Y=[0,-1,-1,0,1,0,0,1];function K(e,t){for(var r=t.value,n=t.x,i=t.y,o=e.size,a=!1,s=0;s<Y.length;s+=2){var u=t.x+Y[s],f=t.y+Y[s+1];if(u>0&&f>0&&u<o&&f<o){var h=e.heightFn(u,f);h>r&&(r=h,n=u,i=f,a=!0)}}return!!a&&{x:n,y:i,value:r,points:[]}}function X(e){var t=function(e){var t=[],r=e.size,n=r*r/1e3;console.log("Probe count =",n);for(var i=0;i<n;i++){var o=e.random.next()*r|0,a=e.random.next()*r|0,s=e.heightFn(o,a);s>y&&t.push({x:o,y:a,value:s,points:[],tile:0})}return t}(e);console.log(t.length,"random probes");var r=e.size,n=t.length,i=0,o=0;for(o=0;o<r/2&&i<n;o++)for(var a=i;a<n;a++){var s=K(e,t[a]);if(s)t[a]=s;else{var u=t[i];t[i]=t[a],t[a]=u,i++}}var f=function(e){for(var t=e.length,r=[],n=0;n<t;n++){for(var i=e[n],o=!0,a=t-1;a>n;a--){var s=e[a];if(i.x===s.x&&i.y===s.y){o=!1;break}}o&&r.push(i)}return r}(t);return console.log("Stopped climbing after ",o," iterations: "+f.length+" springs"),function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,n=[],i=0;i<t.length;i++){var o=t[i],a=e.random.nextInt(-r,r),s=e.random.nextInt(-r,r);o.x=o.x+a,o.y=o.y+s,e.heightFn(o.x,o.y)>T&&e.random.next()<.6&&n.push(d({},o,{x:o.x-r-s|0,y:o.y-r+a|0}))}return t.concat(n)}(e,f)}function H(e,t){for(var r=1/0,n=t.x,i=t.y,o=-1,a=-1,s=!1,u=e.size,f=0;f<Y.length;f+=2){var h=t.x+Y[f],l=t.y+Y[f+1];if(h>0&&l>0&&h<u&&l<u){var c=e.read(h,l);if(!W(c,k)){if(W(c,R)){var d=e.heightCoords(h,l),p=d.nx,v=d.ny,b=d.nz,y=d.nw;c=e.noise4D(p*m,y*m,v*m,b*m)<0?C:A}var g=e.heightFn(h,l)-(!W(c,S)&&W(c,t.tile)?.001:0);g<r&&(r=g,n=h,i=l,o=c,a=f,s=!0)}}}if(s){var x=e.random.next();if(x<.25){var T=2*(a/2+(x<.125?-1:1)&3);t.x+=Y[T],t.y+=Y[T+1],t.points.push(t.x,t.y),t.x+=Y[T],t.y+=Y[T+1],t.value=1,t.tile=L[e.read(t.x,t.y)]}else t.x=n,t.y=i,t.value=r,t.tile=L[o]}else{var w=2*e.random.nextInt(0,3);t.x+=Y[w],t.y+=Y[w+1],t.tile=L[e.read(t.x,t.y)]}}function Q(e){var t=X(e),r=e.size,n=t.length,i=0,o=0;for(o=0;o<r&&i<n;o++)for(var a=i;a<n;a++){var s=t[a],u=s.x,f=s.y;if(s.points.push(u,f),W(e.read(s.x,s.y),w)){var l=t[i];t[i]=t[a],t[a]=l,i++}else H(e,s)}console.log("Stopped flowing after ",o," iterations");for(var c=0;c<t.length;c++)for(var d=t[c].points,p=0;p<d.length;p+=2){var v=0|Math.min(8,.004*p);h(e,d[p],d[p+1],v)}for(var m=0;m<t.length;m++)console.log("Spring length",t[m].points.length)}var J=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:800,n=arguments.length>1?arguments[1]:void 0;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Math.log(r)/Math.log(2)%1!=0)throw new Error("Size must be power of two: "+r);console.log("New map "+r+" x "+r+", seed = "+n),this.random=new s.a(n),this.noise=new a.a(function(){return t.random.next()}),this.size=r,this.sizeMask=r-1,this.fineMask=(r<<4)-1,this.factor=1/r,this.tiles=new Uint8Array(r*r),this.things=new Uint8Array(r*r)}var t,r,n;return t=e,n=[{key:"generate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(new Date).getTime(),r=f()(),n=N(e,t),i=f()();Q(n);var o=f()();return console.log("Base in ".concat(i-r,"ms")),console.log("Rivers in ".concat(o-r,"ms")),console.log({thingStats:n.things.reduce(function(e,t){return e[t]=void 0===e[t]?1:e[t]+1,e},[])}),n}}],(r=[{key:"read",value:function(e,t){return this.tiles[t*this.size+e]}},{key:"getThing",value:function(e,t){return this.things[t*this.size+e]}},{key:"write",value:function(e,t,r){this.tiles[t*this.size+e]=r}},{key:"putThing",value:function(e,t,r){this.things[t*this.size+e]=r}},{key:"heightFn",value:function(e,t,r){var n,i,o,a,s=e*this.factor,u=t*this.factor;r?(n=r.nx,i=r.ny,o=r.nz,a=r.nw):(n=Math.cos(s*v),i=Math.cos(u*v),o=Math.sin(s*v),a=Math.sin(u*v));var f,h=this.noise4D(.4*n,.4*i,.4*o,.4*a),l=this.noise4D(1.4*n,1.4*a,1.4*i,1.4*o);return((f=h<0?-h*h:h*h)<-1?-1:f>1?1:f)+.3*l}},{key:"heightCoords",value:function(e,t){var r=e*this.factor,n=t*this.factor;return{nx:Math.cos(r*v),ny:Math.cos(n*v),nz:Math.sin(r*v),nw:Math.sin(n*v)}}},{key:"render",value:function(e){for(var t=this.size,r=e.createImageData(t,t),n=r.data,i=0,o=0,a=0;a<t;a++)for(var s=0;s<t;s++){switch(this.tiles[i++]){case k:case 20:case 21:n[o++]=255,n[o++]=0,n[o++]=128,n[o++]=255;break;case w:case 1:case 2:n[o++]=0,n[o++]=32,n[o++]=128,n[o++]=255;break;case S:case 4:case 5:n[o++]=192,n[o++]=160,n[o++]=0,n[o++]=255;break;case C:case 7:case 8:n[o++]=0,n[o++]=128,n[o++]=0,n[o++]=255;break;case M:case z:case 17:n[o++]=0,n[o++]=108,n[o++]=16,n[o++]=255;break;case 18:n[o++]=0,n[o++]=64,n[o++]=32,n[o++]=255;break;case A:case 10:case 11:n[o++]=64,n[o++]=64,n[o++]=0,n[o++]=255;break;case R:case 13:case 14:n[o++]=100,n[o++]=100,n[o++]=100,n[o++]=255;break;case O:case 23:case 24:n[o++]=255,n[o++]=0,n[o++]=255,n[o++]=255}}return r}},{key:"noise4D",value:function(e,t,r,n){return this.noise.noise4D(e,t,r,n)}}])&&l(t.prototype,r),n&&l(t,n),e}()},32:function(e,t,r){"use strict";r.r(t);r(5),r(1);var n=r(3);window.onload=function(){var e=document.querySelector("div.loading");e.parentNode.removeChild(e);var t=document.createElement("canvas");t.width=2048,t.height=2048,document.getElementById("root").appendChild(t);var r=t.getContext("2d"),i=n.f.generate(2048,"floppy-disk").render(r);r.putImageData(i,0,0),t.addEventListener("click",function(e){console.log("Click at ".concat(e.clientX,", ").concat(e.clientY))},!0),console.log("ready")}},5:function(e,t,r){(function(e){!function(t){var r=function(e){this.tileAnim=[0,0],this.dontUseTransform=!1,this.renderer=e,this.tileAnim=[0,0]};t.CanvasTileRenderer=r;var n=e.CanvasRenderer;n&&n.registerPlugin("tilemap",r)}(r||(r={}));var t,r,n=this&&this.__extends||(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)});!function(t){var r=function(r){function i(e,t,n){var i=r.call(this)||this;return i.modificationMarker=0,i.shadowColor=new Float32Array([0,0,0,.5]),i._globalMat=null,i.initialize.apply(i,arguments),i}return n(i,r),i.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},i.prototype.initialize=function(e,r,n){!0===n&&(n=0),this.z=this.zIndex=e,this.texPerChild=n||t.Constant.boundCountPerBuffer*t.Constant.maxTextures,r&&this.setBitmaps(r)},i.prototype.setBitmaps=function(e){var r,n=this.texPerChild,i=this.children.length,o=Math.ceil(e.length/n);for(r=0;r<i;r++)this.children[r].textures=e.slice(r*n,(r+1)*n);for(r=i;r<o;r++){var a=new t.RectTileLayer(this.zIndex,e.slice(r*n,(r+1)*n));a.compositeParent=!0,a.offsetX=t.Constant.boundSize,a.offsetY=t.Constant.boundSize,this.addChild(a)}},i.prototype.clear=function(){for(var e=0;e<this.children.length;e++)this.children[e].clear();this.modificationMarker=0},i.prototype.addRect=function(e,t,r,n,i,o,a){var s=e/this.texPerChild>>0,u=e%this.texPerChild;this.children[s]&&this.children[s].textures&&this.children[s].addRect(u,t,r,n,i,o,a)},i.prototype.addFrame=function(r,n,i,o,a){var s,u=null,f=0,h=this.children;if("number"==typeof r){if(u=h[r/this.texPerChild>>0])f=r%this.texPerChild;else{if(!(u=h[0]))return!1;f=0}s=u.textures[f]}else{s="string"==typeof r?e.Texture.from(r):r;for(var l=0;l<h.length;l++){for(var c=(p=h[l]).textures,d=0;d<c.length;d++)if(c[d].baseTexture===s.baseTexture){u=p,f=d;break}if(u)break}if(!u){for(l=0;l<h.length;l++){var p;if((p=h[l]).textures.length<this.texPerChild){u=p,f=p.textures.length,p.textures.push(s);break}}u||((u=new t.RectTileLayer(this.zIndex,s)).compositeParent=!0,u.offsetX=t.Constant.boundSize,u.offsetY=t.Constant.boundSize,h.push(u),f=0)}}return u.addRect(f,s.frame.x,s.frame.y,n,i,s.frame.width,s.frame.height,o,a),!0},i.prototype.renderCanvas=function(e){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){if(!e.plugins.tilemap.dontUseTransform){var t=this.worldTransform;e.context.setTransform(t.a,t.b,t.c,t.d,t.tx*e.resolution,t.ty*e.resolution)}for(var r=this.children,n=0;n<r.length;n++)r[n].renderCanvasCore(e)}},i.prototype.render=function(e){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){var t=e.plugins.tilemap,r=t.getShader();e.batch.setObjectRenderer(t),this._globalMat=r.uniforms.projTransMatrix,e.globalUniforms.uniforms.projectionMatrix.copyTo(this._globalMat).append(this.worldTransform),r.uniforms.shadowColor=this.shadowColor,r.uniforms.animationFrame=t.tileAnim,e.shader.bind(r,!1);for(var n=this.children,i=0;i<n.length;i++)n[i].renderWebGLCore(e,t)}},i.prototype.isModified=function(e){var t=this.children;if(this.modificationMarker!==t.length)return!0;for(var r=0;r<t.length;r++)if(t[r].isModified(e))return!0;return!1},i.prototype.clearModify=function(){var e=this.children;this.modificationMarker=e.length;for(var t=0;t<e.length;t++)e[t].clearModify()},i}(e.Container);t.CompositeRectTileLayer=r}(r||(r={})),function(t){t.Constant={maxTextures:4,bufferSize:2048,boundSize:1024,boundCountPerBuffer:1,use32bitIndex:!1,SCALE_MODE:e.SCALE_MODES.LINEAR,DO_CLEAR:!0}}(r||(r={})),r||(r={}),function(t){function r(e){var r=t.call(this)||this;return r.zIndex=e,r}n(r,t),r.prototype.renderCanvas=function(t){var r=null;t.plugins.tilemap.dontUseTransform&&(r=this.transform.worldTransform,this.transform.worldTransform=e.Matrix.IDENTITY),t.plugins.graphics.render(this),t.plugins.tilemap.dontUseTransform&&(this.transform.worldTransform=r),t.context.globalAlpha=1},r.prototype.isModified=function(e){return!1},r.prototype.clearModify=function(){}}(e.Graphics),function(t){var r=function(r){function i(t){var n=r.call(this,t.bufferSize,t.bufferSize)||this;n.DO_CLEAR=!1,n.boundSize=0,n._clearBuffer=null,n.baseTex=null,n.boundSprites=[],n.dirties=[];var i=n.boundSprites,o=n.dirties;n.boundSize=t.boundSize;for(var a=0;a<t.boundCountPerBuffer;a++){var s=new e.Sprite;s.position.x=t.boundSize*(1&a),s.position.y=t.boundSize*(a>>1),i.push(s),o.push(0)}return n.DO_CLEAR=!!t.DO_CLEAR,n}return n(i,r),i.prototype.bind=function(e){if(this.baseTex)throw new Error("Only one baseTexture is allowed for this resource!");this.baseTex=e,r.prototype.bind.call(this,e)},i.prototype.setTexture=function(e,t){var r=this.boundSprites[e];r.texture.baseTexture!==t.baseTexture&&(r.texture=t,this.baseTex.update(),this.dirties[e]=this.baseTex.dirtyId)},i.prototype.upload=function(e,r,n){var i=e.gl,o=this.width,a=this.height;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),n.dirtyId<0&&(n.width=o,n.height=a,i.texImage2D(r.target,0,r.format,o,a,0,r.format,r.type,null));var s=this.DO_CLEAR;s&&!this._clearBuffer&&(this._clearBuffer=new Uint8Array(t.Constant.boundSize*t.Constant.boundSize*4));for(var u=this.boundSprites,f=0;f<u.length;f++){var h=u[f],l=h.texture.baseTexture;if(!(n.dirtyId>=this.dirties[f])){var c=l.resource;l.valid&&c&&c.source&&(s&&(l.width<this.boundSize||l.height<this.boundSize)&&i.texSubImage2D(r.target,0,h.position.x,h.position.y,this.boundSize,this.boundSize,r.format,r.type,this._clearBuffer),i.texSubImage2D(r.target,0,h.position.x,h.position.y,r.format,r.type,c.source))}}return!0},i}(e.resources.Resource);t.MultiTextureResource=r}(r||(r={})),function(t){var r=function(r){function i(e,t){var n=r.call(this)||this;return n.zIndex=0,n.modificationMarker=0,n.shadowColor=new Float32Array([0,0,0,.5]),n._globalMat=null,n.pointsBuf=[],n.hasAnim=!1,n.offsetX=0,n.offsetY=0,n.compositeParent=!1,n.vbId=0,n.vb=null,n.vbBuffer=null,n.vbArray=null,n.vbInts=null,n.initialize(e,t),n}return n(i,r),i.prototype.initialize=function(e,t){t?t instanceof Array||!t.baseTexture||(t=[t]):t=[],this.textures=t,this.zIndex=e},i.prototype.clear=function(){this.pointsBuf.length=0,this.modificationMarker=0,this.hasAnim=!1},i.prototype.addFrame=function(t,r,n,i,o){var a,s=0;if("number"==typeof t)s=t,a=this.textures[s];else{a="string"==typeof t?e.Texture.from(t):t;for(var u=!1,f=this.textures,h=0;h<f.length;h++)if(f[h].baseTexture===a.baseTexture){s=h,u=!0;break}if(!u)return!1}return this.addRect(s,a.frame.x,a.frame.y,r,n,a.frame.width,a.frame.height,i,o),!0},i.prototype.addRect=function(e,t,r,n,i,o,a,s,u){void 0===s&&(s=0),void 0===u&&(u=0);var f=this.pointsBuf;if(this.hasAnim=this.hasAnim||s>0||u>0,o===a)f.push(t),f.push(r),f.push(n),f.push(i),f.push(o),f.push(a),f.push(0|s),f.push(0|u),f.push(e);else{var h=void 0;if(o%a==0)for(h=0;h<o/a;h++)f.push(t+h*a),f.push(r),f.push(n+h*a),f.push(i),f.push(a),f.push(a),f.push(0|s),f.push(0|u),f.push(e);else if(a%o==0)for(h=0;h<a/o;h++)f.push(t),f.push(r+h*o),f.push(n),f.push(i+h*o),f.push(o),f.push(o),f.push(0|s),f.push(0|u),f.push(e);else f.push(t),f.push(r),f.push(n),f.push(i),f.push(o),f.push(a),f.push(0|s),f.push(0|u),f.push(e)}},i.prototype.renderCanvas=function(e){if(!e.plugins.tilemap.dontUseTransform){var t=this.worldTransform;e.context.setTransform(t.a,t.b,t.c,t.d,t.tx*e.resolution,t.ty*e.resolution)}this.renderCanvasCore(e)},i.prototype.renderCanvasCore=function(e){if(0!==this.textures.length){var t=this.pointsBuf;e.context.fillStyle="#000000";for(var r=0,n=t.length;r<n;r+=9){var i=t[r],o=t[r+1],a=t[r+2],s=t[r+3],u=t[r+4],f=t[r+5];i+=t[r+6]*e.plugins.tilemap.tileAnim[0],o+=t[r+7]*e.plugins.tilemap.tileAnim[1];var h=t[r+8];h>=0?e.context.drawImage(this.textures[h].baseTexture.source,i,o,u,f,a,s,u,f):(e.context.globalAlpha=.5,e.context.fillRect(a,s,u,f),e.context.globalAlpha=1)}}},i.prototype.destroyVb=function(){this.vb&&(this.vb.destroy(),this.vb=null)},i.prototype.render=function(e){var t=e.plugins.tilemap,r=t.getShader();e.batch.setObjectRenderer(t),this._globalMat=r.uniforms.projTransMatrix,e.globalUniforms.uniforms.projectionMatrix.copyTo(this._globalMat).append(this.worldTransform),r.uniforms.shadowColor=this.shadowColor,r.uniforms.animationFrame=t.tileAnim,e.shader.bind(r,!1),this.renderWebGLCore(e,t)},i.prototype.renderWebGLCore=function(r,n){var i=this.pointsBuf;if(0!==i.length){var o=i.length/9,a=n.getShader(),s=this.textures;if(0!==s.length){n.bindTextures(r,a,s);var u=this.vb;u||(u=n.createVb(),this.vb=u,this.vbId=u.id,this.vbBuffer=null,this.modificationMarker=0),n.checkIndexBuffer(o,u);var f=t.Constant.boundCountPerBuffer,h=u.getBuffer("aVertexPosition"),l=o*u.vertPerQuad;if(0!==l){if(this.modificationMarker!==l){this.modificationMarker=l;var c=u.stride*l;if(!this.vbBuffer||this.vbBuffer.byteLength<c){for(var d=u.stride;d<c;)d*=2;this.vbBuffer=new ArrayBuffer(d),this.vbArray=new Float32Array(this.vbBuffer),this.vbInts=new Uint32Array(this.vbBuffer),h.update(this.vbBuffer)}for(var p=this.vbArray,v=(this.vbInts,0),m=0,b=this.offsetX,y=this.offsetY,g=0;g<i.length;g+=9){this.compositeParent&&(f>1?(m=i[g+8]>>2,b=this.offsetX*(1&i[g+8]),y=this.offsetY*(i[g+8]>>1&1)):(m=i[g+8],b=0,y=0));var x=i[g+2],T=i[g+3],w=i[g+4],S=i[g+5],C=i[g]+b,A=i[g+1]+y,R=i[g+6],M=i[g+7];p[v++]=x,p[v++]=T,p[v++]=C,p[v++]=A,p[v++]=C+.5,p[v++]=A+.5,p[v++]=C+w-.5,p[v++]=A+S-.5,p[v++]=R,p[v++]=M,p[v++]=m,p[v++]=x+w,p[v++]=T,p[v++]=C+w,p[v++]=A,p[v++]=C+.5,p[v++]=A+.5,p[v++]=C+w-.5,p[v++]=A+S-.5,p[v++]=R,p[v++]=M,p[v++]=m,p[v++]=x+w,p[v++]=T+S,p[v++]=C+w,p[v++]=A+S,p[v++]=C+.5,p[v++]=A+.5,p[v++]=C+w-.5,p[v++]=A+S-.5,p[v++]=R,p[v++]=M,p[v++]=m,p[v++]=x,p[v++]=T+S,p[v++]=C,p[v++]=A+S,p[v++]=C+.5,p[v++]=A+.5,p[v++]=C+w-.5,p[v++]=A+S-.5,p[v++]=R,p[v++]=M,p[v++]=m}h.update(p)}r.geometry.bind(u,a),r.geometry.draw(e.DRAW_MODES.TRIANGLES,6*o,0)}}}},i.prototype.isModified=function(e){return!!(this.modificationMarker!==this.pointsBuf.length||e&&this.hasAnim)},i.prototype.clearModify=function(){this.modificationMarker=this.pointsBuf.length},i.prototype.destroy=function(e){r.prototype.destroy.call(this,e),this.destroyVb()},i}(e.Container);t.RectTileLayer=r}(r||(r={})),function(t){var r="\nvarying vec2 vTextureCoord;\nvarying vec4 vFrame;\nvarying float vTextureId;\nuniform vec4 shadowColor;\nuniform sampler2D uSamplers[%count%];\nuniform vec2 uSamplerSize[%count%];\n\nvoid main(void){\n   vec2 textureCoord = clamp(vTextureCoord, vFrame.xy, vFrame.zw);\n   float textureId = floor(vTextureId + 0.5);\n\n   vec4 color;\n   %forloop%\n   gl_FragColor = color;\n}\n",i="\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aFrame;\nattribute vec2 aAnim;\nattribute float aTextureId;\n\nuniform mat3 projTransMatrix;\nuniform vec2 animationFrame;\n\nvarying vec2 vTextureCoord;\nvarying float vTextureId;\nvarying vec4 vFrame;\n\nvoid main(void){\n   gl_Position = vec4((projTransMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vec2 anim = aAnim * animationFrame;\n   vTextureCoord = aTextureCoord + anim;\n   vFrame = aFrame + vec4(anim, anim);\n   vTextureId = aTextureId;\n}\n",o=function(r){function i(n,i,o){var a=r.call(this,new e.Program(i,o),{animationFrame:new Float32Array(2),uSamplers:[],uSamplerSize:[],projTransMatrix:new e.Matrix})||this;return a.maxTextures=0,a.maxTextures=n,t.shaderGenerator.fillSamplers(a,a.maxTextures),a}return n(i,r),i}(e.Shader);t.TilemapShader=o;var a=function(e){function o(n){var o=e.call(this,n,i,t.shaderGenerator.generateFragmentSrc(n,r))||this;return t.shaderGenerator.fillSamplers(o,o.maxTextures),o}return n(o,e),o}(o);t.RectTileShader=a;var s=function(t){function r(){var r=t.call(this)||this;r.vertSize=11,r.vertPerQuad=4,r.stride=4*r.vertSize,r.lastTimeAccess=0;var n=r.buf=new e.Buffer(new Float32Array(2),!0,!1);return r.addAttribute("aVertexPosition",n,0,!1,0,r.stride,0).addAttribute("aTextureCoord",n,0,!1,0,r.stride,8).addAttribute("aFrame",n,0,!1,0,r.stride,16).addAttribute("aAnim",n,0,!1,0,r.stride,32).addAttribute("aTextureId",n,0,!1,0,r.stride,40),r}return n(r,t),r}(e.Geometry);t.RectTileGeom=s}(r||(r={})),function(t){var r=function(r){function i(n){var i=r.call(this,n)||this;return i.sn=-1,i.indexBuffer=null,i.ibLen=0,i.tileAnim=[0,0],i.texLoc=[],i.texResources=[],i.rectShader=new t.RectTileShader(t.Constant.maxTextures),i.indexBuffer=new e.Buffer(void 0,!0,!0),i.checkIndexBuffer(2e3),i.initBounds(),i}return n(i,r),i.prototype.initBounds=function(){if(!(t.Constant.boundCountPerBuffer<=1))for(var r=t.Constant.maxTextures,n=0;n<r;n++){var i=new t.MultiTextureResource(t.Constant),o=new e.BaseTexture(i);o.scaleMode=t.Constant.SCALE_MODE,o.wrapMode=e.WRAP_MODES.CLAMP,this.texResources.push(i)}},i.prototype.bindTexturesWithoutRT=function(e,t,r){var n=t.uniforms.uSamplerSize;this.texLoc.length=0;for(var i=0;i<r.length;i++){var o=r[i];if(!o||!o.valid)return;e.texture.bind(r[i],i),n[2*i]=1/r[i].baseTexture.width,n[2*i+1]=1/r[i].baseTexture.height}t.uniforms.uSamplerSize=n},i.prototype.bindTextures=function(e,r,n){var i=n.length,o=t.Constant.maxTextures;if(!(i>t.Constant.boundCountPerBuffer*o))if(t.Constant.boundCountPerBuffer<=1)this.bindTexturesWithoutRT(e,r,n);else{for(var a=0;a<i;a++){var s=n[a];if(s&&s.valid)this.texResources[a>>2].setTexture(3&a,s)}var u=a+3>>2;for(a=0;a<u;a++)e.texture.bind(this.texResources[a].baseTex,a)}},i.prototype.start=function(){},i.prototype.createVb=function(){var e=new t.RectTileGeom;return e.addIndex(this.indexBuffer),e.lastTimeAccess=Date.now(),e},i.prototype.checkIndexBuffer=function(r,n){void 0===n&&(n=null);var i=6*r;if(!(i<=this.ibLen)){for(var o=i;o<i;)o<<=1;this.ibLen=i,this.indexBuffer.update(e.utils.createIndicesForQuads(r,t.Constant.use32bitIndex))}},i.prototype.getShader=function(){return this.rectShader},i.prototype.destroy=function(){r.prototype.destroy.call(this),this.rectShader=null},i}(e.ObjectRenderer);t.TileRenderer=r,e.Renderer.registerPlugin("tilemap",r)}(r||(r={})),function(t){var r=function(t){function r(e,r){var n=t.call(this)||this;return n._lastAnimationFrame=-1,n.tilemap=e,n.z=r,n}return n(r,t),r.prototype.clear=function(){for(var e=this.children,t=0;t<e.length;t++)e[t].clear();this._previousLayers=0},r.prototype.cacheIfDirty=function(){var t=this.tilemap,r=this.children,n=this._previousLayers!==r.length;this._previousLayers=r.length;var i,o=this.canvasBuffer,a=this._tempRender;if(o||(o=this.canvasBuffer=document.createElement("canvas"),(a=this._tempRender=new e.CanvasRenderer(100,100,{view:o})).context=a.rootContext,a.plugins.tilemap.dontUseTransform=!0),o.width===t._layerWidth&&o.height===t._layerHeight||(o.width=t._layerWidth,o.height=t._layerHeight,n=!0),!n)for(i=0;i<r.length;i++)if(r[i].isModified(this._lastAnimationFrame!==t.animationFrame)){n=!0;break}if(this._lastAnimationFrame=t.animationFrame,n)for(t._hackRenderer&&t._hackRenderer(a),a.context.clearRect(0,0,o.width,o.height),i=0;i<r.length;i++)r[i].clearModify(),r[i].renderCanvas(a);for(this.layerTransform=this.worldTransform,i=0;i<r.length;i++){this.layerTransform=r[i].worldTransform;break}},r.prototype.renderCanvas=function(e){this.cacheIfDirty();var t=this.layerTransform;e.context.setTransform(t.a,t.b,t.c,t.d,t.tx*e.resolution,t.ty*e.resolution);this.tilemap;e.context.drawImage(this.canvasBuffer,0,0)},r}(e.Container);t.ZLayer=r}(r||(r={})),function(t){e.tilemap=t}(r||(r={})),function(e){!function(t){t.fillSamplers=function(t,r){for(var n=[],i=0;i<r;i++)n[i]=i;t.uniforms.uSamplers=n;var o=[];for(i=0;i<r;i++)o.push(1/e.Constant.bufferSize),o.push(1/e.Constant.bufferSize);t.uniforms.uSamplerSize=o},t.generateFragmentSrc=function(e,t){return t.replace(/%count%/gi,e+"").replace(/%forloop%/gi,this.generateSampleSrc(e))},t.generateSampleSrc=function(e){var t="";t+="\n",t+="\n",t+="if(vTextureId <= -1.0) {",t+="\n\tcolor = shadowColor;",t+="\n}";for(var r=0;r<e;r++)t+="\nelse ",r<e-1&&(t+="if(textureId == "+r+".0)"),t+="\n{",t+="\n\tcolor = texture2D(uSamplers["+r+"], textureCoord * uSamplerSize["+r+"]);",t+="\n}";return t+="\n",t+="\n"}}(e.shaderGenerator||(e.shaderGenerator={}))}(r||(r={}))}).call(this,r(2))}});
//# sourceMappingURL=bundle-height-5b4602bd66ed66a3f391.js.map